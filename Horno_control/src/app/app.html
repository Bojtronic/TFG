<div class="home-container">
  <mat-card class="configCard">
    <h2 class="emq-title">{{ title() }}</h2>
    <div class="emq-subtitle">Configuración MQTT</div>
    <form class="config-form">
      <mat-grid-list cols="4" rowHeight="4:1">
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Servidor</mat-label>
            <input matInput [(ngModel)]="connection.hostname" name="hostname">
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Puerto</mat-label>
            <input matInput type="number" [(ngModel)]="connection.port" name="port">
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Endpoint</mat-label>
            <input matInput [(ngModel)]="connection.path" name="path">
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Client ID</mat-label>
            <input matInput [(ngModel)]="connection.clientId" name="clientId">
          </mat-form-field>
        </mat-grid-tile>
      </mat-grid-list>
    </form>
    <mat-grid-list cols="8" rowHeight="4:1">
      <mat-grid-tile>
        <button mat-raised-button color="primary"
                (click)="createConnection()" [disabled]="isConnected">
          {{ isConnected ? 'Conectado' : 'Conectar' }}
        </button>
      </mat-grid-tile>
      <mat-grid-tile>
        <button mat-raised-button color="warn" 
                (click)="destroyConnection()" [disabled]="!isConnected">
          Desconectar
        </button>
      </mat-grid-tile>
    </mat-grid-list>
  </mat-card>

  <mat-card class="subscriptionCard">
    <div class="emq-title">Suscripción</div>
    <form class="config-form">
      <mat-grid-list cols="4" rowHeight="4:1">
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Tópico</mat-label>
            <input matInput [(ngModel)]="subscription.topic" name="subTopic">
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Calidad de Servicio (QoS)</mat-label>
            <mat-select [(ngModel)]="subscription.qos" name="subQos">
              <mat-option *ngFor="let item of qosList" [value]="item.value">
                {{ item.label }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </mat-grid-tile>
      </mat-grid-list>
    </form>
    <mat-grid-list cols="8" rowHeight="4:1">
      <mat-grid-tile>
        <button mat-raised-button color="primary"
                (click)="doSubscribe()" 
                [disabled]="!isConnected || subscribeSuccess">
          {{ subscribeSuccess ? 'Suscrito' : 'Suscribir' }}
        </button>
      </mat-grid-tile>
      <mat-grid-tile>
        <button mat-raised-button color="warn" 
                (click)="doUnsubscribe()" 
                [disabled]="!subscribeSuccess">
          Cancelar Suscripción
        </button>
      </mat-grid-tile>
    </mat-grid-list>
  </mat-card>

  <mat-card class="publishCard">
    <div class="emq-title">Publicación</div>
    <form class="config-form">
      <mat-grid-list cols="4" rowHeight="4:1">
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Tópico</mat-label>
            <input matInput [(ngModel)]="publish.topic" name="pubTopic">
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Mensaje</mat-label>
            <textarea matInput [(ngModel)]="publish.payload" name="pubPayload"></textarea>
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>QoS</mat-label>
            <mat-select [(ngModel)]="publish.qos" name="pubQos">
              <mat-option *ngFor="let item of qosList" [value]="item.value">
                {{ item.label }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </mat-grid-tile>
      </mat-grid-list>
    </form>
    <mat-grid-list cols="8" rowHeight="4:1">
      <mat-grid-tile>
        <button mat-raised-button color="primary" 
                (click)="doPublish()" 
                [disabled]="!isConnected">
          Publicar
        </button>
      </mat-grid-tile>
    </mat-grid-list>
  </mat-card>

  <mat-card class="receiveCard">
    <div class="emq-title">Mensajes Recibidos</div>
    <mat-form-field appearance="fill" class="full-width">
      <textarea matInput readonly>{{receiveNews}}</textarea>
    </mat-form-field>
  </mat-card>
</div>

<router-outlet></router-outlet>